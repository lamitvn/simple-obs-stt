<!DOCTYPE html>
<html lang="en" data-theme="dracula" class="bg-base-100">
<head>
  <meta charset="UTF-8">
  <title>Server</title>
  <script src="index.js" type="text/javascript"></script>
  <link href="../css/style.css" rel="stylesheet" type="text/css">
</head>
  <body class="flex flex-col relative h-screen">
    <div class="flex-1 container mx-auto p-4 text-base-content flex flex-col items-center justify-center">
      <h1 class="font-bold text-5xl mb-8">OBS STT</h1>
      <div id="view" class="w-72 flex flex-col">
      </div>
    </div>
    <div class="self-center absolute mx-auto bottom-12 w-72 flex flex-col">
      <div class="flex justify-between">STT Service <span class="font-semibold" id="status-stt">-</span></div>
      <div class="flex justify-between">Language <span class="font-semibold" id="status-language">-</span></div>
      <div class="flex justify-between">Network <span class="font-semibold" id="status-network">-</span></div>
    </div>
    <template id="view-connect">
      <div class="flex flex-col" x-data="{selectedLanguage: null, dialectList: [], showDialectSelection: false, selectedDialect: null}">
        <div class="flex flex-col mb-4">
          <select class="select select-bordered w-full max-w-xs mb-2" x-model="selectedLanguage" @change="
          const [_langName, ...list] = langs[$event.target.value];
          let selected = null;
          dialectList = list;
          showDialectSelection = list.length > 1;
          selected = list.length > 1 ? null : list[0][0];
          selectedDialect = selected;
          server.SelectDialect(selected);
    ">
            <option :value="null" selected="selected">Choose your language</option>
            <template x-for="(value, index) in langs">
              <option :value="index" x-text="value[0]">telekinesis</option>
            </template>
          </select>
          <template x-if="showDialectSelection">
            <select class="select select-bordered w-full max-w-xs" x-model="selectedDialect" @change="server.SelectDialect($event.target.value)">
              <option :value="null" selected="selected">Choose your dialect</option>
              <template x-for="(value, index, collection) in dialectList">
                <option :value="value[0]" x-text="value[1]">telekinesis</option>
              </template>
            </select>
          </template>
        </div>

        <div class="flex space-x-2 mb-2">
          <input type="password" placeholder="OBS browser source*" class="w-full input input-bordered">
          <button class="btn btn-primary" @click="server.Init()">Start</button>
        </div>
        <small class="text-base-content">* Use this field if you don't want to change OBS browser source URL every session. <br> Please, for your own security, do not use stupid shit like "mystream-123".
          <a class="underline" href="https://passwordsgenerator.net/sha512-hash-generator/">Use Generator</a>. <br> Leave field empty for one time session.
        </small>

<!--        <button @click="server.Init()" class="btn mb-4">Start server</button>-->
      </div>
    </template>

    <template id="view-running">
      <div class="flex flex-col" x-data="{}">
        <svg xmlns="http://www.w3.org/2000/svg" class="text-error self-center h-24 w-24 mb-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z" />
        </svg>

        <div id="stt-value" class="h-48 self-center w-96 bg-base-200 mb-8 p-4 rounded-md border-2 border-base-300">...</div>

        <button @click="server.Reset()" class="btn mb-4">Stop server</button>
        <button @click="server.CopyLink()" class="btn btn-outline">Copy link</button>
      </div>
    </template>

    <template id="view-starting">
      <div class="flex flex-col">
        <button disabled class="btn mb-4">Starting...</button>
      </div>
    </template>
  </body>
</html>
